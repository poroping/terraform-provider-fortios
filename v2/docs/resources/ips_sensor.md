---
subcategory: "FortiGate Ips"
layout: "fortios"
page_title: "FortiOS: fortios_ips_sensor"
description: |-
  Configure IPS sensor.
---

## fortios_ips_sensor
Configure IPS sensor.

## Example Usage

```hcl

```

## Argument Reference
* `vdomparam` - Specifies the vdom to which the data source will be applied when the FortiGate unit is running in VDOM mode. Only one vdom can be specified. If you want to inherit the vdom configuration of the provider, please do not set this parameter.
* `allow_append` - If set to true allows provider to overwrite existing resources instead of erroring. Useful for brownfield implementations. Use with caution! Requires `name` to be defined.
* `dynamic_sort_table` - `true` or `false`, set this parameter to `true` when using dynamic for_each + toset to configure and sort sub-tables, if set to `true` static sub-tables must be ordered.

* `block_malicious_url` - Enable/disable malicious URL blocking. Valid values: `disable` `enable` .
* `comment` - Comment.
* `extended_log` - Enable/disable extended logging. Valid values: `enable` `disable` .
* `name` - Sensor name.
* `replacemsg_group` - Replacement message group. This attribute must reference one of the following datasources: `system.replacemsg-group.name` .
* `scan_botnet_connections` - Block or monitor connections to Botnet servers, or disable Botnet scanning. Valid values: `disable` `block` `monitor` .
* `entries` - IPS sensor filter. The structure of `entries` block is documented below.

The `entries` block contains:

* `action` - Action taken with traffic in which signatures are detected. Valid values: `pass` `block` `reset` `default` .
* `application` - Applications to be protected. set application ? lists available applications. all includes all applications. other includes all unlisted applications.
* `id` - Rule ID in IPS database (0 - 4294967295).
* `location` - Protect client or server traffic.
* `log` - Enable/disable logging of signatures included in filter. Valid values: `disable` `enable` .
* `log_attack_context` - Enable/disable logging of attack context: URL buffer, header buffer, body buffer, packet buffer. Valid values: `disable` `enable` .
* `log_packet` - Enable/disable packet logging. Enable to save the packet that triggers the filter. You can download the packets in pcap format for diagnostic use. Valid values: `disable` `enable` .
* `os` - Operating systems to be protected.  all includes all operating systems. other includes all unlisted operating systems.
* `protocol` - Protocols to be examined. set protocol ? lists available protocols. all includes all protocols. other includes all unlisted protocols.
* `quarantine` - Quarantine method. Valid values: `none` `attacker` .
* `quarantine_expiry` - Duration of quarantine. (Format ###d##h##m, minimum 1m, maximum 364d23h59m, default = 5m). Requires quarantine set to attacker.
* `quarantine_log` - Enable/disable quarantine logging. Valid values: `disable` `enable` .
* `rate_count` - Count of the rate.
* `rate_duration` - Duration (sec) of the rate.
* `rate_mode` - Rate limit mode. Valid values: `periodical` `continuous` .
* `rate_track` - Track the packet protocol field. Valid values: `none` `src-ip` `dest-ip` `dhcp-client-mac` `dns-domain` .
* `severity` - Relative severity of the signature, from info to critical. Log messages generated by the signature include the severity.
* `status` - Status of the signatures included in filter. default enables the filter and only use filters with default status of enable. Filters with default status of disable will not be used. Valid values: `disable` `enable` `default` .
* `cve` - List of CVE IDs of the signatures to add to the sensor The structure of `cve` block is documented below.

The `cve` block contains:

* `cve_entry` - CVE IDs or CVE wildcards.
* `exempt_ip` - Traffic from selected source or destination IP addresses is exempt from this signature. The structure of `exempt_ip` block is documented below.

The `exempt_ip` block contains:

* `dst_ip` - Destination IP address and netmask (applies to packet matching the signature).
* `id` - Exempt IP ID.
* `src_ip` - Source IP address and netmask (applies to packet matching the signature).
* `rule` - Identifies the predefined or custom IPS signatures to add to the sensor. The structure of `rule` block is documented below.

The `rule` block contains:

* `id` - Rule IPS.
* `filter` - IPS sensor filter. The structure of `filter` block is documented below.

The `filter` block contains:

* `action` - Action of selected rules. Valid values: `pass` `block` `reset` `default` .
* `application` - Vulnerable application filter.
* `location` - Vulnerability location filter.
* `log` - Enable/disable logging of selected rules. Valid values: `disable` `enable` .
* `log_packet` - Enable/disable packet logging of selected rules. Valid values: `disable` `enable` .
* `name` - Filter name.
* `os` - Vulnerable OS filter.
* `protocol` - Vulnerable protocol filter.
* `quarantine` - Quarantine IP or interface. Valid values: `none` `attacker` .
* `quarantine_expiry` - Duration of quarantine in minute.
* `quarantine_log` - Enable/disable logging of selected quarantine. Valid values: `disable` `enable` .
* `severity` - Vulnerability severity filter.
* `status` - Selected rules status. Valid values: `disable` `enable` `default` .
* `override` - IPS override rule. The structure of `override` block is documented below.

The `override` block contains:

* `action` - Action of override rule. Valid values: `pass` `block` `reset` .
* `log` - Enable/disable logging. Valid values: `disable` `enable` .
* `log_packet` - Enable/disable packet logging. Valid values: `disable` `enable` .
* `quarantine` - Quarantine IP or interface. Valid values: `none` `attacker` .
* `quarantine_expiry` - Duration of quarantine in minute.
* `quarantine_log` - Enable/disable logging of selected quarantine. Valid values: `disable` `enable` .
* `rule_id` - Override rule ID.
* `status` - Enable/disable status of override rule. Valid values: `disable` `enable` .
* `exempt_ip` - Exempted IP. The structure of `exempt_ip` block is documented below.

The `exempt_ip` block contains:

* `dst_ip` - Destination IP address and netmask.
* `id` - Exempt IP ID.
* `src_ip` - Source IP address and netmask.

## Attribute Reference

In addition to all the above arguments, the following attributes are exported:
* `id` - an identifier for the resource with format {{mkey}}.

## Import

Check out `allow_append` to auto import upon resource creation.

fortios_ips_sensor can be imported using:
```sh
terraform import fortios_ips_sensor.labelname {{mkey}}
```
